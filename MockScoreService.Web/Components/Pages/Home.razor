@page "/"
@using MockScoreService.Web.Data
@using MockScoreService.Web.Models
@using Microsoft.EntityFrameworkCore
@inject FootballDbContext DbContext


<PageTitle>Dashboard</PageTitle>

<MudText Typo="Typo.h3" GutterBottom="true">Dashboard</MudText>
<MudText Class="mb-8">Bienvenue sur le simulateur d'API Football</MudText>

<MudGrid>
    <MudItem xs="12" sm="6" md="3">
        <MudPaper Elevation="2" Class="pa-4">
            <MudText Typo="Typo.h4">@_totalMatches</MudText>
            <MudText Typo="Typo.body1">Matchs Total</MudText>
        </MudPaper>
    </MudItem>
    <MudItem xs="12" sm="6" md="3">
        <MudPaper Elevation="2" Class="pa-4">
            <MudText Typo="Typo.h4">@_scheduledMatches</MudText>
            <MudText Typo="Typo.body1">À Venir</MudText>
        </MudPaper>
    </MudItem>
    <MudItem xs="12" sm="6" md="3">
        <MudPaper Elevation="2" Class="pa-4">
            <MudText Typo="Typo.h4">@_inPlayMatches</MudText>
            <MudText Typo="Typo.body1">En Cours</MudText>
        </MudPaper>
    </MudItem>
    <MudItem xs="12" sm="6" md="3">
        <MudPaper Elevation="2" Class="pa-4">
            <MudText Typo="Typo.h4">@_finishedMatches</MudText>
            <MudText Typo="Typo.body1">Terminés</MudText>
        </MudPaper>
    </MudItem>
</MudGrid>

<MudPaper Class="pa-4 mt-4">
    <MudText Typo="Typo.h5" GutterBottom="true">Actions Rapides</MudText>
    <MudButton Variant="Variant.Filled" Color="Color.Primary" Href="/matches" StartIcon="@Icons.Material.Filled.Add">
        Créer un Match
    </MudButton>
    <MudButton Variant="Variant.Filled" Color="Color.Secondary" Href="/simulation" StartIcon="@Icons.Material.Filled.PlayArrow" Class="ml-2">
        Lancer Simulation
    </MudButton>
</MudPaper>

@code {
    private int _totalMatches;
    private int _scheduledMatches;
    private int _inPlayMatches;
    private int _finishedMatches;

    protected override async Task OnInitializedAsync()
    {
        _totalMatches = await DbContext.Matches.CountAsync();
        _scheduledMatches = await DbContext.Matches.CountAsync(m => m.Status == "SCHEDULED");
        _inPlayMatches = await DbContext.Matches.CountAsync(m => m.Status == "IN_PLAY");
        _finishedMatches = await DbContext.Matches.CountAsync(m => m.Status == "FINISHED");
    }
}
